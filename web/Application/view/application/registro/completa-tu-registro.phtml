<?php $this->form->prepare(); ?>
<section>
    <div class="box_center">
        <div class="welcome_box signin_complete">
            <div class="yellow_box">Completa tu registro</div>
            <div class="purple_box">
                <div class="error_message hide"><span class="icon"></span><span class="text">Lo sentimos, no se pudo completar el proceso, por favor inténtalo mas tarde</span></div>
                <?php echo $this->form()->openTag($this->form->setAttributes(array('class' => 'signin_form', 'data-parsley-validate' => 'data-parsley-validate'))); ?>
                <?php  $this->formElementerrors()->setMessageOpenFormat('<ul class="parsley-errors-list filled"><li class="parsley-required">')->setMessageCloseString('</li></ul>'); ?>
                    <h3>Tus datos de cuenta</h3>
                    <div class="content_form">
                        <div class="form_control">
                            <label class="left" for="email">Correo</label>
                            <div class="right">
                                <?php $disabledCss = ($disabledEmail) ? 'disabled-email' : ''; ?>
                                <?php echo $this->formElement($this->form->get('email')->setAttributes(array(
                                    'class' => $disabledCss,
                                    'data-parsley-required' => 'true',
                                    'data-parsley-required-message' => 'Este campo es requerido y no puede estar vacío'
                                ))) ?>
                                <?php echo $this->formElementerrors($form->get('email')); ?>
                            </div>
                            
                        </div>
                        <div class="form_control">
                            <label class="left" for="password">Contraseña</label>
                            <div class="right">
                                <?php echo $this->formElement($this->form->get('password')->setAttributes(array(
                                    'class' => '',
                                    'data-parsley-required' => 'true',
                                    'data-parsley-required-message' => 'Este campo es requerido y no puede estar vacío'
                                ))) ?>
                                <?php echo $this->formElementerrors($form->get('password')); ?>
                            </div>
                            
                        </div>
                        <div class="form_control">
                            <label class="left" for="password_repeat">Repetir contraseña</label>
                            <div class="right">
                                <?php echo $this->formElement($this->form->get('password_repeat')->setAttributes(array(
                                    'class' => '',
                                    'data-parsley-required' => 'true',
                                    'data-parsley-required-message' => 'Este campo es requerido y no puede estar vacío'
                                ))) ?>
                                <?php echo $this->formElementerrors($form->get('password_repeat')); ?>
                            </div>
                            
                        </div>
                    </div>
                    <hr/>
                    <h3>Tus datos personales</h3>
                    <div class="content_form">
                        <div class="form_control">
                            <label class="left" for="nombres">Nombre</label>
                            <div class="right">
                                <?php echo $this->formElement($this->form->get('nombres')->setAttributes(array(
                                    'class' => '',
                                    'data-parsley-required' => 'true',
                                    'data-parsley-required-message' => 'Este campo es requerido y no puede estar vacío'
                                ))) ?>
                                <?php echo $this->formElementerrors($form->get('nombres')); ?>
                            </div>
                            
                        </div>
                        <div class="form_control">
                            <label class="left" for="paterno">Apellido paterno</label>
                            <div class="right">
                                <?php echo $this->formElement($this->form->get('paterno')->setAttributes(array(
                                    'class' => '',
                                    'data-parsley-required' => 'true',
                                    'data-parsley-required-message' => 'Este campo es requerido y no puede estar vacío'
                                ))) ?>
                                <?php echo $this->formElementerrors($form->get('paterno')); ?>
                            </div>
                            
                        </div>
                        <div class="form_control">
                            <label class="left" for="materno">Apellido materno</label>
                            <div class="right">
                                <?php echo $this->formElement($this->form->get('materno')->setAttributes(array(
                                    'class' => '',
                                    'data-parsley-required' => 'true',
                                    'data-parsley-required-message' => 'Este campo es requerido y no puede estar vacío'
                                ))) ?>
                                <?php echo $this->formElementerrors($form->get('materno')); ?>
                            </div>
                            
                        </div>
                        <div class="form_control">
                            <label class="left" for="di_valor">Documento de identidad</label>
                            <div class="right">
                                <div class="bg_white doc_type">
                                    <?php echo $this->formElement($this->form->get('di_tipo')->setAttributes(array(
                                        'class' => '',
                                    ))) ?>
                                </div>
                                <?php echo $this->formElement($this->form->get('di_valor')->setAttributes(array(
                                        'class' => 'inp_right dni_input',
                                        'placeholder' => 'Nro de documento',
                                        'data-parsley-required' => 'true',
                                        'data-parsley-required-message' => 'Este campo es requerido y no puede estar vacío'
                                    ))) ?>
                            </div>
                            <div class="right">
                            <?php echo $this->formElementerrors($form->get('di_valor')); ?>
                            </div>
                        </div>
                        <div class="form_control">
                            <label class="left" for="departamento_id">Departamento</label>
                            <div class="right bg_white">
                                <?php echo $this->formElement($this->form->get('departamento_id')->setAttributes(array(
                                    'class' => '',
                                ))) ?>
                            </div>
                            <div class="right error_message_dep">
                                <?php echo $this->formElementerrors($form->get('departamento_id')); ?>
                            </div>
                        </div>
                        <div class="form_control">
                            <label class="left" for="provincia_id">Provincia</label>
                            <div class="right bg_white">
                                <?php echo $this->formElement($this->form->get('provincia_id')->setAttributes(array(
                                    'class' => '',
                                ))) ?>
                                
                            </div>
                            <div class="right error_message_pro">
                                <?php echo $this->formElementerrors($form->get('provincia_id')); ?>
                            </div>
                        </div>
                        <div class="form_control">
                            <label class="left" for="distrito_id">Distrito</label>
                            <div class="right bg_white">
                                <?php echo $this->formElement($this->form->get('distrito_id')->setAttributes(array(
                                    'class' => '',
                                ))) ?>
                            </div>
                            <div class="right error_message_dis">
                                <?php echo $this->formElementerrors($form->get('distrito_id')); ?>
                            </div>
                        </div>
                        <div class="form_control">
                            <label class="left">Fecha de nacimiento</label>
                            <div class="right">
                                <div class="day bg_white">
                                    <?php echo $this->formElement($this->form->get('dia')->setAttributes(array(
                                        'class' => '',
                                    ))) ?>
                                </div>
                                <div class="month bg_white">
                                    <?php echo $this->formElement($this->form->get('mes')->setAttributes(array(
                                        'class' => '',
                                    ))) ?>
                                </div>
                                <div class="year bg_white">
                                    <?php echo $this->formElement($this->form->get('anio')->setAttributes(array(
                                        'class' => '',
                                    ))) ?>
                                </div>
                            </div>
                            <div class="right">
                                <?php echo $this->formElementerrors($form->get('dia')); ?>
                            </div>
                        </div>
                        <div class="form_control">
                            <div class="right">
                                <?php echo $this->formRow($form->get('token_csrf')); ?>
                                <button type="submit" class="btn btn_orange btn_save_signin">Registrarme</button>
                                <p class="term">Al registrarte en Coney Club, aceptas los <a target="_blank" href="<?php echo BASE_URL . 'terminos-condiciones' ?>">términos y condiciones</a>&nbsp y nuestra <a target="_blank" href="<?php echo BASE_URL . 'politicas-privacidad' ?>">política de privacidad</a></p>
                            </div>
                        </div>
                    </div>
                <?php echo $this->form()->closeTag(); ?>
                <hr/>
                <div class="login_link"><a href="<?php echo BASE_URL ?>login">Ya tengo una cuenta en Coney Park<span></span></a></div>
            </div>
        </div>
        
    </div>
    <div id="modal_response_signin" class="modal_box" data-open="<?php echo $openPopapConfRegistro; ?>">
      <div class="modal_content modal_recovery_content"><span class="icon_logo"></span>
        <?php echo $mensajeRegistro; ?>
          <button onclick="location.href='<?php echo BASE_URL ?>login';" class="close btn btn_orange">Aceptar</button>
      </div>
    </div>
    <div id="mask"></div>
</section>
<script type="text/javascript">
    var ubigeo = {
        loadProvincia:function(){
            $.ajax({
                type: "GET",
                url: '<?php echo BASE_URL; ?>application/ubigeo/provincia',
                data:{departamento_id:$('#departamento_id').val()},
                dataType: 'json',
                success: function(data){
                    var htmlDdl = '<option value="">- Seleccione -</option>';
                    for (var key in data) {
                        htmlDdl = htmlDdl+'<option value="'+key+'">'+data[key]+'</option>';
                    }
                    $('#provincia_id').html(htmlDdl);
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) { 
                }
            });
        },
        loadDistrito:function(){
            $.ajax({
                type: "GET",
                url: '<?php echo BASE_URL; ?>application/ubigeo/distrito',
                data:{provincia_id:$('#provincia_id').val()},
                dataType: 'json',
                success: function(data){
                    var htmlDdl = '<option value="">- Seleccione -</option>';
                    for (var key in data) {
                        htmlDdl = htmlDdl+'<option value="'+key+'">'+data[key]+'</option>';
                    }
                    $('#distrito_id').html(htmlDdl);
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) { 
                }
            });
        }
    };
    
    $(document).ready(function(){
        $('#departamento_id').change(function(){ubigeo.loadProvincia();});
        $('#provincia_id').change(function(){ubigeo.loadDistrito();});
    });
</script>