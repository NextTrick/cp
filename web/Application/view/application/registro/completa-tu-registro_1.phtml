<?php $this->form->prepare(); ?>
<div class="box">
    <div class="box-header with-border">
        <label>Registrarse</label>
    </div>
    <?php echo $this->form()->openTag($this->form->setAttribute('class', 'form-horizontal')); ?>
    <div class="box-body">
        <div class="form-group">
            <label class="col-sm-2 control-label" for="email">Correo <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('email')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('email')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="password">Contreseña <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('password')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('password')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="password_repeat">Repetir contreseña <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('password_repeat')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('password_repeat')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="nombres">Nombres <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('nombres')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('nombres')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="paterno">Apellido paterno <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('paterno')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('paterno')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="materno">Apellido materno <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('materno')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('materno')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="di_tipo">Documento de identidad <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('di_tipo')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('di_tipo')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('di_valor')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('di_valor')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="cod_pais">Pais <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('cod_pais')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('cod_pais')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="cod_depa">Departamento <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('cod_depa')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('cod_depa')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="cod_dist">Distrito <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('cod_dist')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('cod_dist')); ?></span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="fecha_nac">Fecha Nacimiento <span>*</span></label>
            <div class="col-sm-8">
                <?php echo $this->formElement($this->form->get('fecha_nac')->setAttribute('class', 'form-control')) ?>
                <span class="error"><?php echo $this->formElementerrors($form->get('fecha_nac')); ?></span>
            </div>
        </div>
        <div class="box-footer">
            <?php echo $this->formRow($form->get('token_csrf')); ?>
            <a class="btn btn-default" href="<?php echo BASE_URL; ?>usuario/usuario/index">Regresar</a>
            <button class="btn btn-success" type="submit">Aceptar</button>
        </div>
    </div>
    <?php echo $this->form()->closeTag(); ?>
</div>

<script type="text/javascript">
    var ubigeo = {
        loadDepartameto:function(){
            $.ajax({
                type: "GET",
                url: '<?php echo BASE_URL; ?>application/ubigeo/departamento',
                data:{cod_pais:$('#cod_pais').val()},
                dataType: 'json',
                success: function(data){
                    var htmlDdl = '<option value="">- Seleccione -</option>';
                    for (var key in data) {
                        htmlDdl = htmlDdl+'<option value="'+key+'">'+data[key]+'</option>';
                    }
                    $('#cod_depa').html(htmlDdl);
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) { 
                }
            });
        },
        loadDistrito:function(){
            $.ajax({
                type: "GET",
                url: '<?php echo BASE_URL; ?>application/ubigeo/distrito',
                data:{cod_pais:$('#cod_pais').val(), cod_depa:$('#cod_depa').val()},
                dataType: 'json',
                success: function(data){
                    var htmlDdl = '<option value="">- Seleccione -</option>';
                    for (var key in data) {
                        htmlDdl = htmlDdl+'<option value="'+key+'">'+data[key]+'</option>';
                    }
                    $('#cod_dist').html(htmlDdl);
                },
                error: function(XMLHttpRequest, textStatus, errorThrown) { 
                }
            });
        }
    };
    
    $(document).ready(function(){
        $('#cod_pais').change(function(){ubigeo.loadDepartameto();});
        $('#cod_depa').change(function(){ubigeo.loadDistrito();});
    });
</script>